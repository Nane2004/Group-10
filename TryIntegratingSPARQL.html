<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brain Parts Illustration with Wikidata</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header id="header">
        <h1 style="text-align: center; margin-top: 0; font-family: 'Georgia', sans-serif; font-weight: 700; font-size: 4em; letter-spacing: 5px; text-shadow: 2px 2px 5px rgba(163, 167, 200, 0.588);">
            BRAIN ANATOMY AND PHYSIOLOGY
        </h1>
    </header>

    <main id="main-content" class="container">
        <section id="introduction">
            <p style="text-align: center;">
                This website illustrates human brain anatomy and the functional specialization of its regions to support biomedical research and educational applications. Interactivity can effectively illustrate complex brain functions like memory, movement, and sensory processing. This visualization design hopefully improves user engagement and knowledge retention. Click on any part on the image or in the list on the left side to see detailed information fetched from Wikidata and Wikipedia. The image is from this site made by that person (to be updated).
            </p>
        </section>

        <section id="brain-visualization" style="text-align: center;">
            <div id="image-container" style="position: relative; display: inline-block;">
                <img id="brainImage" src="images/file brain 2024-11-15 at 11.13.10.svg" 
                     alt="Brain Anatomy" width="700" height="500" style="display: block; margin: auto;">
                <div id="overlayContainer" style="position: absolute; top: 0; left: 0; width: 700px; height: 500px; pointer-events: none;"></div>
            </div>
        </section>

        <section id="interaction-panel">
            <div id="styleBox"></div>

            <div id="functionBox" style="display: none;">
                <button id="closeButton" aria-label="Close function box">x</button>
                <h3>Function</h3>
                <p id="functionDescription">Click on a brain part to see its function.</p>
                <p id="wikiLink" style="margin-top: 10px;"></p>
            </div>
        </section>
    </main>

    <footer id="footerBar" style="text-align: center; margin-top: 20px;">
        <p>
            Â© <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener">CC BY 4.0 License</a>. 
            Images used on this site are sourced from <a href="https://stock.adobe.com/" target="_blank" rel="noopener">Adobe Stock</a>.
        </p>
    </footer>

    <script>
        const sparqlEndpoint = 'https://query.wikidata.org/sparql';

        const sparqlQuery = `
            SELECT ?BrainPart ?BrainPartLabel ?BrainPartDescription ?WikipediaArticle
            WHERE {
                VALUES ?BrainPart {
                    wd:Q815334  # Parietal lobe
                    wd:Q744385  # Temporal lobe
                    wd:Q848340  # Occipital lobe
                    wd:Q749520  # Frontal lobe
                    wd:Q338924  # Amygdala
                    wd:Q130983  # Cerebellum
                    wd:Q11345481  # Limbic lobe
                    wd:Q184215  # Thalamus
                    wd:Q164386  # Hypothalamus
                    wd:Q192570  # Pons
                    wd:Q48360   # Hippocampus
                    wd:Q728285  # Broca's area
                    wd:Q156871  # Pituitary gland
                }

                ?BrainPart schema:description ?BrainPartDescription.
                OPTIONAL { ?WikipediaArticle schema:about ?BrainPart; schema:isPartOf <https://en.wikipedia.org/>. }
                FILTER (LANG(?BrainPartDescription) = "en")

                SERVICE wikibase:label { 
                    bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en".
                }
            }
        `;

        const imageMap = {
            'Q749520': 'images/Frontal lobe.svg',
            'Q848340': 'images/Occipital lobe.svg',
            'Q815334': 'images/Parietal lobe final.svg',
            'Q744385': 'images/Temporal Lobe.svg',
            'Q728285': 'images/Brocas area.svg',
            'Q11345481': 'images/Limbic lobe.svg',
            'Q338924': 'images/Amygdala.svg',
            'Q48360': 'images/Hippocampus.svg',
            'Q184215': 'images/thalamus.svg',
            'Q164386': 'images/hypothalamus.svg',
            'Q156871': 'images/pituitary gland.svg',
            'Q189033': 'images/medulla oblongata.svg',
            'Q185080': 'images/midbrain(mesencephalon).svg',
            'Q192570': 'images/Pons (1).svg',
            'Q130983': 'images/Cerebellum.svg',
        };

        async function fetchBrainPartsData() {
            const url = `${sparqlEndpoint}?query=${encodeURIComponent(sparqlQuery)}`;
            try {
                const response = await fetch(url, {
                    headers: {
                        'Accept': 'application/sparql-results+json',
                    },
                });

                if (!response.ok) {
                    throw new Error(`SPARQL query failed with status: ${response.status}`);
                }

                const data = await response.json();
                return data.results.bindings.map((binding) => ({
                    id: binding.BrainPart.value.split('/').pop(),
                    label: binding.BrainPartLabel.value,
                    description: binding.BrainPartDescription.value,
                    wikipedia: binding.WikipediaArticle ? binding.WikipediaArticle.value : null,
                }));
            } catch (error) {
                console.error('Error fetching data from SPARQL endpoint:', error);
                return [];
            }
        }

        async function populateButtons() {
            const styleBox = document.getElementById('styleBox');
            const brainPartsData = await fetchBrainPartsData();

            brainPartsData.forEach((part) => {
                const button = document.createElement('button');
                button.textContent = part.label;
                button.setAttribute('aria-label', `View information about ${part.label}`);

                button.addEventListener('click', () => {
                    const functionBox = document.getElementById('functionBox');
                    const functionDescription = document.getElementById('functionDescription');
                    const wikiLink = document.getElementById('wikiLink');

                    functionDescription.textContent = `${part.label}: ${part.description}`;
                    if (part.wikipedia) {
                        wikiLink.innerHTML = `Learn more on <a href="${part.wikipedia}" target="_blank" rel="noopener">Wikipedia</a>`;
                    } else {
                        wikiLink.textContent = "Wikipedia article not available.";
                    }

                    functionBox.style.display = 'block';

                    const brainImage = document.getElementById('brainImage');
                    const newImagePath = imageMap[part.id];
                    if (newImagePath) {
                        brainImage.src = newImagePath;
                    } else {
                        console.warn(`No image mapped for ID: ${part.id}`);
                    }
                });

                styleBox.appendChild(button);
            });
        }

        document.getElementById('closeButton').addEventListener('click', () => {
            const functionBox = document.getElementById('functionBox');
            functionBox.style.display = 'none';

            const brainImage = document.getElementById('brainImage');
            brainImage.src = 'images/file brain 2024-11-15 at 11.13.10.svg';
        });

        populateButtons();
    </script>
</body>

</html>
